INFO 03-31 16:02:05 [cache_tensor_manager.py:17] USE_GPU_TENSOR_CACHE is On
INFO 03-31 16:02:09 __init__.py:190] Automatically detected platform cuda.
INFO 03-31 16:02:21 [cache_tensor_manager.py:17] USE_GPU_TENSOR_CACHE is On
INFO 03-31 16:02:21 [cache_tensor_manager.py:17] USE_GPU_TENSOR_CACHE is On
INFO 03-31 16:02:21 [cache_tensor_manager.py:17] USE_GPU_TENSOR_CACHE is On
INFO 03-31 16:02:21 [cache_tensor_manager.py:17] USE_GPU_TENSOR_CACHE is On
INFO 03-31 16:02:21 [cache_tensor_manager.py:17] USE_GPU_TENSOR_CACHE is On
INFO 03-31 16:02:21 [cache_tensor_manager.py:17] USE_GPU_TENSOR_CACHE is On
INFO 03-31 16:02:21 [cache_tensor_manager.py:17] USE_GPU_TENSOR_CACHE is On
INFO 03-31 16:02:21 [cache_tensor_manager.py:17] USE_GPU_TENSOR_CACHE is On
INFO 03-31 16:02:28 __init__.py:190] Automatically detected platform cuda.
INFO 03-31 16:02:28 __init__.py:190] Automatically detected platform cuda.
INFO 03-31 16:02:28 __init__.py:190] Automatically detected platform cuda.
INFO 03-31 16:02:28 __init__.py:190] Automatically detected platform cuda.
INFO 03-31 16:02:28 __init__.py:190] Automatically detected platform cuda.
INFO 03-31 16:02:28 __init__.py:190] Automatically detected platform cuda.
INFO 03-31 16:02:28 __init__.py:190] Automatically detected platform cuda.
INFO 03-31 16:02:28 __init__.py:190] Automatically detected platform cuda.
INFO 03-31 16:03:36 [__init__.py:46] select fp8w8a8-b128 quant way: deepgemm-fp8w8a8-b128
INFO 03-31 16:03:36 [__init__.py:46] select fp8w8a8-b128 quant way: deepgemm-fp8w8a8-b128
INFO 03-31 16:03:36 [basemodel.py:117] Initial quantization. The default quantization method is deepgemm-fp8w8a8-b128
INFO 03-31 16:03:36 [basemodel.py:117] Initial quantization. The default quantization method is deepgemm-fp8w8a8-b128
INFO 03-31 16:03:36 [__init__.py:46] select fp8w8a8-b128 quant way: deepgemm-fp8w8a8-b128
INFO 03-31 16:03:36 [basemodel.py:117] Initial quantization. The default quantization method is deepgemm-fp8w8a8-b128
INFO 03-31 16:03:36 [__init__.py:46] select fp8w8a8-b128 quant way: deepgemm-fp8w8a8-b128
INFO 03-31 16:03:36 [__init__.py:46] select fp8w8a8-b128 quant way: deepgemm-fp8w8a8-b128
INFO 03-31 16:03:36 [basemodel.py:117] Initial quantization. The default quantization method is deepgemm-fp8w8a8-b128
INFO 03-31 16:03:36 [basemodel.py:117] Initial quantization. The default quantization method is deepgemm-fp8w8a8-b128
INFO 03-31 16:03:36 [__init__.py:46] select fp8w8a8-b128 quant way: deepgemm-fp8w8a8-b128
INFO 03-31 16:03:36 [basemodel.py:117] Initial quantization. The default quantization method is deepgemm-fp8w8a8-b128
INFO 03-31 16:03:36 [__init__.py:46] select fp8w8a8-b128 quant way: deepgemm-fp8w8a8-b128
INFO 03-31 16:03:36 [basemodel.py:117] Initial quantization. The default quantization method is deepgemm-fp8w8a8-b128
INFO 03-31 16:03:36 [__init__.py:46] select fp8w8a8-b128 quant way: deepgemm-fp8w8a8-b128
INFO 03-31 16:03:36 [basemodel.py:117] Initial quantization. The default quantization method is deepgemm-fp8w8a8-b128
INFO 03-31 16:03:36 [shared_arr.py:17] create shm None_mem_manger_can_use_token_num_6
INFO 03-31 16:03:36 [shared_arr.py:17] create shm None_mem_manger_can_use_token_num_7
INFO 03-31 16:03:36 [shared_arr.py:17] create shm None_mem_manger_can_use_token_num_2
INFO 03-31 16:03:36 [shared_arr.py:17] create shm None_mem_manger_can_use_token_num_5
INFO 03-31 16:03:36 [shared_arr.py:17] create shm None_mem_manger_can_use_token_num_0
INFO 03-31 16:03:36 [shared_arr.py:17] create shm None_mem_manger_can_use_token_num_1
INFO 03-31 16:03:36 [shared_arr.py:17] create shm None_mem_manger_can_use_token_num_3
INFO 03-31 16:03:36 [shared_arr.py:17] create shm None_mem_manger_can_use_token_num_4
INFO 03-31 16:04:46 [cuda_graph.py:195] Begin capture overlap cudagraph, use the --disable_cudagraph to disable it.
INFO 03-31 16:04:50 [cuda_graph.py:195] Begin capture overlap cudagraph, use the --disable_cudagraph to disable it.
INFO 03-31 16:04:50 [cuda_graph.py:195] Begin capture overlap cudagraph, use the --disable_cudagraph to disable it.
INFO 03-31 16:04:52 [cuda_graph.py:195] Begin capture overlap cudagraph, use the --disable_cudagraph to disable it.
INFO 03-31 16:04:52 [cuda_graph.py:195] Begin capture overlap cudagraph, use the --disable_cudagraph to disable it.
INFO 03-31 16:04:57 [cuda_graph.py:195] Begin capture overlap cudagraph, use the --disable_cudagraph to disable it.
INFO 03-31 16:04:57 [cuda_graph.py:195] Begin capture overlap cudagraph, use the --disable_cudagraph to disable it.
INFO 03-31 16:04:58 [cuda_graph.py:195] Begin capture overlap cudagraph, use the --disable_cudagraph to disable it.
WARNING 03-31 16:05:04 [kernel_config.py:40] can not find config_path /mtc/baishihao/lightllm/lightllm/common/all_kernel_configs/moe_silu_and_mul_kernel/{N=2048,out_dtype=torch.bfloat16}_NVIDIA_H200.json kernel name moe_silu_and_mul_kernel use default kernel setting
WARNING 03-31 16:05:04 [kernel_config.py:40] can not find config_path /mtc/baishihao/lightllm/lightllm/common/all_kernel_configs/moe_silu_and_mul_kernel/{N=2048,out_dtype=torch.bfloat16}_NVIDIA_H200.json kernel name moe_silu_and_mul_kernel use default kernel setting
WARNING 03-31 16:05:04 [kernel_config.py:40] can not find config_path /mtc/baishihao/lightllm/lightllm/common/all_kernel_configs/moe_silu_and_mul_kernel/{N=2048,out_dtype=torch.bfloat16}_NVIDIA_H200.json kernel name moe_silu_and_mul_kernel use default kernel setting
WARNING 03-31 16:05:04 [kernel_config.py:40] can not find config_path /mtc/baishihao/lightllm/lightllm/common/all_kernel_configs/moe_silu_and_mul_kernel/{N=2048,out_dtype=torch.bfloat16}_NVIDIA_H200.json kernel name moe_silu_and_mul_kernel use default kernel setting
WARNING 03-31 16:05:04 [kernel_config.py:40] can not find config_path /mtc/baishihao/lightllm/lightllm/common/all_kernel_configs/moe_silu_and_mul_kernel/{N=2048,out_dtype=torch.bfloat16}_NVIDIA_H200.json kernel name moe_silu_and_mul_kernel use default kernel setting
WARNING 03-31 16:05:04 [kernel_config.py:40] can not find config_path /mtc/baishihao/lightllm/lightllm/common/all_kernel_configs/moe_silu_and_mul_kernel/{N=2048,out_dtype=torch.bfloat16}_NVIDIA_H200.json kernel name moe_silu_and_mul_kernel use default kernel setting
WARNING 03-31 16:05:04 [kernel_config.py:40] can not find config_path /mtc/baishihao/lightllm/lightllm/common/all_kernel_configs/moe_silu_and_mul_kernel/{N=2048,out_dtype=torch.bfloat16}_NVIDIA_H200.json kernel name moe_silu_and_mul_kernel use default kernel setting
WARNING 03-31 16:05:04 [kernel_config.py:40] can not find config_path /mtc/baishihao/lightllm/lightllm/common/all_kernel_configs/moe_silu_and_mul_kernel/{N=2048,out_dtype=torch.bfloat16}_NVIDIA_H200.json kernel name moe_silu_and_mul_kernel use default kernel setting
INFO 03-31 16:05:17 [cache_tensor_manager.py:71] pid 3114581 cuda graph alloc graph out mem (128, 129280) torch.float32 16547840 16547840
INFO 03-31 16:05:17 [cache_tensor_manager.py:73] cuda graph managed_total_tensor_bytes: 66191360
INFO 03-31 16:05:17 [cache_tensor_manager.py:71] pid 3114581 cuda graph alloc graph out mem (128, 129280) torch.float32 16547840 16547840
INFO 03-31 16:05:17 [cache_tensor_manager.py:73] cuda graph managed_total_tensor_bytes: 132382720
INFO 03-31 16:05:17 [cache_tensor_manager.py:71] pid 3114575 cuda graph alloc graph out mem (128, 129280) torch.float32 16547840 16547840
INFO 03-31 16:05:17 [cache_tensor_manager.py:73] cuda graph managed_total_tensor_bytes: 66191360
INFO 03-31 16:05:17 [cache_tensor_manager.py:71] pid 3114575 cuda graph alloc graph out mem (128, 129280) torch.float32 16547840 16547840
INFO 03-31 16:05:17 [cache_tensor_manager.py:73] cuda graph managed_total_tensor_bytes: 132382720
INFO 03-31 16:05:17 [cache_tensor_manager.py:71] pid 3114582 cuda graph alloc graph out mem (128, 129280) torch.float32 16547840 16547840
INFO 03-31 16:05:17 [cache_tensor_manager.py:73] cuda graph managed_total_tensor_bytes: 66191360
INFO 03-31 16:05:17 [cache_tensor_manager.py:71] pid 3114582 cuda graph alloc graph out mem (128, 129280) torch.float32 16547840 16547840
INFO 03-31 16:05:17 [cache_tensor_manager.py:73] cuda graph managed_total_tensor_bytes: 132382720
INFO 03-31 16:05:17 [cache_tensor_manager.py:71] pid 3114580 cuda graph alloc graph out mem (128, 129280) torch.float32 16547840 16547840
INFO 03-31 16:05:17 [cache_tensor_manager.py:73] cuda graph managed_total_tensor_bytes: 66191360
INFO 03-31 16:05:17 [cache_tensor_manager.py:71] pid 3114580 cuda graph alloc graph out mem (128, 129280) torch.float32 16547840 16547840
INFO 03-31 16:05:17 [cache_tensor_manager.py:73] cuda graph managed_total_tensor_bytes: 132382720
INFO 03-31 16:05:17 [cache_tensor_manager.py:71] pid 3114576 cuda graph alloc graph out mem (128, 129280) torch.float32 16547840 16547840
INFO 03-31 16:05:17 [cache_tensor_manager.py:73] cuda graph managed_total_tensor_bytes: 66191360
INFO 03-31 16:05:17 [cache_tensor_manager.py:71] pid 3114576 cuda graph alloc graph out mem (128, 129280) torch.float32 16547840 16547840
INFO 03-31 16:05:17 [cache_tensor_manager.py:73] cuda graph managed_total_tensor_bytes: 132382720
INFO 03-31 16:05:17 [cache_tensor_manager.py:71] pid 3114577 cuda graph alloc graph out mem (128, 129280) torch.float32 16547840 16547840
INFO 03-31 16:05:17 [cache_tensor_manager.py:73] cuda graph managed_total_tensor_bytes: 66191360
INFO 03-31 16:05:17 [cache_tensor_manager.py:71] pid 3114577 cuda graph alloc graph out mem (128, 129280) torch.float32 16547840 16547840
INFO 03-31 16:05:17 [cache_tensor_manager.py:73] cuda graph managed_total_tensor_bytes: 132382720
INFO 03-31 16:05:17 [cache_tensor_manager.py:71] pid 3114586 cuda graph alloc graph out mem (128, 129280) torch.float32 16547840 16547840
INFO 03-31 16:05:17 [cache_tensor_manager.py:73] cuda graph managed_total_tensor_bytes: 66191360
INFO 03-31 16:05:17 [cache_tensor_manager.py:71] pid 3114586 cuda graph alloc graph out mem (128, 129280) torch.float32 16547840 16547840
INFO 03-31 16:05:17 [cache_tensor_manager.py:73] cuda graph managed_total_tensor_bytes: 132382720
INFO 03-31 16:05:17 [cache_tensor_manager.py:71] pid 3114583 cuda graph alloc graph out mem (128, 129280) torch.float32 16547840 16547840
INFO 03-31 16:05:17 [cache_tensor_manager.py:73] cuda graph managed_total_tensor_bytes: 66191360
INFO 03-31 16:05:17 [cache_tensor_manager.py:71] pid 3114583 cuda graph alloc graph out mem (128, 129280) torch.float32 16547840 16547840
INFO 03-31 16:05:17 [cache_tensor_manager.py:73] cuda graph managed_total_tensor_bytes: 132382720
INFO 03-31 16:07:36 [cuda_graph.py:264] Capture overlap cudagraph success, batch_size <=128 and max_len_in_batch <= 16384 will infer with cudagraph.
INFO 03-31 16:07:36 [basemodel.py:592] disable_check_max_len_infer is true
INFO 03-31 16:07:36 [cuda_graph.py:264] Capture overlap cudagraph success, batch_size <=128 and max_len_in_batch <= 16384 will infer with cudagraph.
INFO 03-31 16:07:36 [basemodel.py:592] disable_check_max_len_infer is true
INFO 03-31 16:07:36 [cuda_graph.py:264] Capture overlap cudagraph success, batch_size <=128 and max_len_in_batch <= 16384 will infer with cudagraph.
INFO 03-31 16:07:36 [basemodel.py:592] disable_check_max_len_infer is true
INFO 03-31 16:07:36 [cuda_graph.py:264] Capture overlap cudagraph success, batch_size <=128 and max_len_in_batch <= 16384 will infer with cudagraph.
INFO 03-31 16:07:36 [basemodel.py:592] disable_check_max_len_infer is true
INFO 03-31 16:07:36 [cuda_graph.py:264] Capture overlap cudagraph success, batch_size <=128 and max_len_in_batch <= 16384 will infer with cudagraph.
INFO 03-31 16:07:36 [basemodel.py:592] disable_check_max_len_infer is true
INFO 03-31 16:07:36 [cuda_graph.py:264] Capture overlap cudagraph success, batch_size <=128 and max_len_in_batch <= 16384 will infer with cudagraph.
INFO 03-31 16:07:36 [basemodel.py:592] disable_check_max_len_infer is true
INFO 03-31 16:07:36 [cuda_graph.py:264] Capture overlap cudagraph success, batch_size <=128 and max_len_in_batch <= 16384 will infer with cudagraph.
INFO 03-31 16:07:36 [basemodel.py:592] disable_check_max_len_infer is true
INFO 03-31 16:07:36 [cuda_graph.py:264] Capture overlap cudagraph success, batch_size <=128 and max_len_in_batch <= 16384 will infer with cudagraph.
INFO 03-31 16:07:36 [basemodel.py:592] disable_check_max_len_infer is true
Profile Prefill
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
void deep_ep::intranode::cached_notify_combine<8>(vo...         0.00%       0.000us         0.00%       0.000us       0.000us     453.800ms        27.75%     453.800ms       7.824ms            58  
                             _per_token_group_quant_fp8         0.00%       0.000us         0.00%       0.000us       0.000us     152.996ms         9.36%     152.996ms     281.760us           543  
void deep_ep::intranode::combine<__nv_bfloat16, 8, 7...         0.00%       0.000us         0.00%       0.000us       0.000us     127.234ms         7.78%     127.234ms       2.194ms            58  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us      95.771ms         5.86%      95.771ms       2.902ms            33  
                                  _fwd_kernel_ep_gather         0.00%       0.000us         0.00%       0.000us       0.000us      87.144ms         5.33%      87.144ms       1.502ms            58  
void deep_gemm::fp8_gemm_kernel<7168u, 16384u, 128u,...         0.00%       0.000us         0.00%       0.000us       0.000us      85.171ms         5.21%      85.171ms       1.396ms            61  
void deep_ep::intranode::dispatch<8, 512>(int4*, flo...         0.00%       0.000us         0.00%       0.000us       0.000us      82.235ms         5.03%      82.235ms       1.418ms            58  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us      79.064ms         4.84%      79.064ms       3.163ms            25  
                                         _rotary_kernel         0.00%       0.000us         0.00%       0.000us       0.000us      64.634ms         3.95%      64.634ms       1.060ms            61  
void deep_gemm::fp8_gemm_kernel<7168u, 2048u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us      50.931ms         3.11%      50.931ms       1.543ms            33  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 147.247ms
Self CUDA time total: 1.635s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 64u, 1...         0.00%       0.000us         0.00%       0.000us       0.000us      23.635ms        23.47%      23.635ms     203.750us           116  
void deep_ep::internode_ll::combine<3, 10, 7168, 9>(...         0.00%       0.000us         0.00%       0.000us       0.000us      14.249ms        14.15%      14.249ms      61.418us           232  
void deep_gemm::fp8_gemm_kernel<7168u, 2048u, 64u, 1...         0.00%       0.000us         0.00%       0.000us       0.000us      12.032ms        11.95%      12.032ms     103.724us           116  
                               _block_scaled_block_gemm         0.00%       0.000us         0.00%       0.000us       0.000us      11.774ms        11.69%      11.774ms      96.511us           122  
void deep_ep::internode_ll::dispatch<true, 3, 10, 71...         0.00%       0.000us         0.00%       0.000us       0.000us       8.826ms         8.76%       8.826ms      38.043us           232  
void deep_gemm::fp8_gemm_kernel<7168u, 16384u, 64u, ...         0.00%       0.000us         0.00%       0.000us       0.000us       4.455ms         4.42%       4.455ms      36.514us           122  
                             _per_token_group_quant_fp8         0.00%       0.000us         0.00%       0.000us       0.000us       2.565ms         2.55%       2.565ms       3.503us           732  
                                    grouped_topk_kernel         0.00%       0.000us         0.00%       0.000us       0.000us       2.369ms         2.35%       2.369ms      20.424us           116  
void deep_gemm::fp8_gemm_kernel<24576u, 1536u, 64u, ...         0.00%       0.000us         0.00%       0.000us       0.000us       1.844ms         1.83%       1.844ms      15.116us           122  
                                         _rotary_kernel         0.00%       0.000us         0.00%       0.000us       0.000us       1.840ms         1.83%       1.840ms      15.083us           122  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 206.557ms
Self CUDA time total: 100.701ms

Profile Prefill
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
void deep_ep::intranode::cached_notify_combine<8>(vo...         0.00%       0.000us         0.00%       0.000us       0.000us     402.588ms        24.62%     402.588ms       6.941ms            58  
                             _per_token_group_quant_fp8         0.00%       0.000us         0.00%       0.000us       0.000us     157.847ms         9.65%     157.847ms     290.695us           543  
void deep_ep::intranode::combine<__nv_bfloat16, 8, 7...         0.00%       0.000us         0.00%       0.000us       0.000us     127.285ms         7.78%     127.285ms       2.195ms            58  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us     122.665ms         7.50%     122.665ms       3.717ms            33  
                                  _fwd_kernel_ep_gather         0.00%       0.000us         0.00%       0.000us       0.000us      96.130ms         5.88%      96.130ms       1.657ms            58  
void deep_gemm::fp8_gemm_kernel<7168u, 16384u, 128u,...         0.00%       0.000us         0.00%       0.000us       0.000us      84.163ms         5.15%      84.163ms       1.380ms            61  
void deep_ep::intranode::dispatch<8, 512>(int4*, flo...         0.00%       0.000us         0.00%       0.000us       0.000us      82.017ms         5.02%      82.017ms       1.414ms            58  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us      74.654ms         4.57%      74.654ms       2.986ms            25  
                                         _rotary_kernel         0.00%       0.000us         0.00%       0.000us       0.000us      64.757ms         3.96%      64.757ms       1.062ms            61  
void deep_gemm::fp8_gemm_kernel<7168u, 2048u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us      64.682ms         3.96%      64.682ms       1.960ms            33  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 147.155ms
Self CUDA time total: 1.635s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 64u, 1...         0.00%       0.000us         0.00%       0.000us       0.000us      24.364ms        24.61%      24.364ms     210.033us           116  
void deep_ep::internode_ll::combine<3, 10, 7168, 9>(...         0.00%       0.000us         0.00%       0.000us       0.000us      12.885ms        13.01%      12.885ms      55.539us           232  
void deep_gemm::fp8_gemm_kernel<7168u, 2048u, 64u, 1...         0.00%       0.000us         0.00%       0.000us       0.000us      12.448ms        12.57%      12.448ms     107.310us           116  
                               _block_scaled_block_gemm         0.00%       0.000us         0.00%       0.000us       0.000us      11.874ms        11.99%      11.874ms      97.331us           122  
void deep_ep::internode_ll::dispatch<true, 3, 10, 71...         0.00%       0.000us         0.00%       0.000us       0.000us       7.179ms         7.25%       7.179ms      30.945us           232  
void deep_gemm::fp8_gemm_kernel<7168u, 16384u, 64u, ...         0.00%       0.000us         0.00%       0.000us       0.000us       4.440ms         4.48%       4.440ms      36.391us           122  
                             _per_token_group_quant_fp8         0.00%       0.000us         0.00%       0.000us       0.000us       2.571ms         2.60%       2.571ms       3.512us           732  
                                    grouped_topk_kernel         0.00%       0.000us         0.00%       0.000us       0.000us       2.388ms         2.41%       2.388ms      20.588us           116  
                                         _rotary_kernel         0.00%       0.000us         0.00%       0.000us       0.000us       1.868ms         1.89%       1.868ms      15.309us           122  
void deep_gemm::fp8_gemm_kernel<24576u, 1536u, 64u, ...         0.00%       0.000us         0.00%       0.000us       0.000us       1.852ms         1.87%       1.852ms      15.178us           122  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 206.236ms
Self CUDA time total: 99.017ms

Profile Prefill
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
void deep_ep::intranode::cached_notify_combine<8>(vo...         0.00%       0.000us         0.00%       0.000us       0.000us     428.535ms        26.29%     428.535ms       7.389ms            58  
                             _per_token_group_quant_fp8         0.00%       0.000us         0.00%       0.000us       0.000us     155.428ms         9.53%     155.428ms     286.239us           543  
void deep_ep::intranode::combine<__nv_bfloat16, 8, 7...         0.00%       0.000us         0.00%       0.000us       0.000us     126.975ms         7.79%     126.975ms       2.189ms            58  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us     108.243ms         6.64%     108.243ms       3.608ms            30  
                                  _fwd_kernel_ep_gather         0.00%       0.000us         0.00%       0.000us       0.000us      93.057ms         5.71%      93.057ms       1.604ms            58  
void deep_gemm::fp8_gemm_kernel<7168u, 16384u, 128u,...         0.00%       0.000us         0.00%       0.000us       0.000us      83.856ms         5.14%      83.856ms       1.375ms            61  
void deep_ep::intranode::dispatch<8, 512>(int4*, flo...         0.00%       0.000us         0.00%       0.000us       0.000us      77.038ms         4.73%      77.038ms       1.328ms            58  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us      76.195ms         4.67%      76.195ms       2.721ms            28  
                                         _rotary_kernel         0.00%       0.000us         0.00%       0.000us       0.000us      64.733ms         3.97%      64.733ms       1.061ms            61  
void deep_gemm::fp8_gemm_kernel<7168u, 2048u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us      57.751ms         3.54%      57.751ms       1.925ms            30  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 141.966ms
Self CUDA time total: 1.630s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 64u, 1...         0.00%       0.000us         0.00%       0.000us       0.000us      23.701ms        23.45%      23.701ms     204.319us           116  
void deep_ep::internode_ll::combine<3, 10, 7168, 9>(...         0.00%       0.000us         0.00%       0.000us       0.000us      14.273ms        14.12%      14.273ms      61.523us           232  
void deep_gemm::fp8_gemm_kernel<7168u, 2048u, 64u, 1...         0.00%       0.000us         0.00%       0.000us       0.000us      12.176ms        12.05%      12.176ms     104.966us           116  
                               _block_scaled_block_gemm         0.00%       0.000us         0.00%       0.000us       0.000us      11.776ms        11.65%      11.776ms      96.525us           122  
void deep_ep::internode_ll::dispatch<true, 3, 10, 71...         0.00%       0.000us         0.00%       0.000us       0.000us       9.036ms         8.94%       9.036ms      38.947us           232  
void deep_gemm::fp8_gemm_kernel<7168u, 16384u, 64u, ...         0.00%       0.000us         0.00%       0.000us       0.000us       4.439ms         4.39%       4.439ms      36.386us           122  
                             _per_token_group_quant_fp8         0.00%       0.000us         0.00%       0.000us       0.000us       2.563ms         2.54%       2.563ms       3.502us           732  
                                    grouped_topk_kernel         0.00%       0.000us         0.00%       0.000us       0.000us       2.353ms         2.33%       2.353ms      20.287us           116  
void deep_gemm::fp8_gemm_kernel<24576u, 1536u, 64u, ...         0.00%       0.000us         0.00%       0.000us       0.000us       1.839ms         1.82%       1.839ms      15.071us           122  
                                         _rotary_kernel         0.00%       0.000us         0.00%       0.000us       0.000us       1.804ms         1.78%       1.804ms      14.786us           122  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 207.065ms
Self CUDA time total: 101.069ms

Profile Prefill
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
void deep_ep::intranode::cached_notify_combine<8>(vo...         0.00%       0.000us         0.00%       0.000us       0.000us     455.682ms        27.87%     455.682ms       7.857ms            58  
                             _per_token_group_quant_fp8         0.00%       0.000us         0.00%       0.000us       0.000us     153.747ms         9.40%     153.747ms     283.145us           543  
void deep_ep::intranode::combine<__nv_bfloat16, 8, 7...         0.00%       0.000us         0.00%       0.000us       0.000us     127.157ms         7.78%     127.157ms       2.192ms            58  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us      92.087ms         5.63%      92.087ms       2.878ms            32  
                                  _fwd_kernel_ep_gather         0.00%       0.000us         0.00%       0.000us       0.000us      87.277ms         5.34%      87.277ms       1.505ms            58  
void deep_gemm::fp8_gemm_kernel<7168u, 16384u, 128u,...         0.00%       0.000us         0.00%       0.000us       0.000us      83.508ms         5.11%      83.508ms       1.369ms            61  
void deep_ep::intranode::dispatch<8, 512>(int4*, flo...         0.00%       0.000us         0.00%       0.000us       0.000us      81.226ms         4.97%      81.226ms       1.400ms            58  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us      79.736ms         4.88%      79.736ms       3.067ms            26  
                                         _rotary_kernel         0.00%       0.000us         0.00%       0.000us       0.000us      64.673ms         3.96%      64.673ms       1.060ms            61  
void deep_gemm::fp8_gemm_kernel<7168u, 2048u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us      50.474ms         3.09%      50.474ms       1.577ms            32  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 145.967ms
Self CUDA time total: 1.635s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 64u, 1...         0.00%       0.000us         0.00%       0.000us       0.000us      24.163ms        24.42%      24.163ms     208.305us           116  
void deep_ep::internode_ll::combine<3, 10, 7168, 9>(...         0.00%       0.000us         0.00%       0.000us       0.000us      13.422ms        13.56%      13.422ms      57.855us           232  
void deep_gemm::fp8_gemm_kernel<7168u, 2048u, 64u, 1...         0.00%       0.000us         0.00%       0.000us       0.000us      12.371ms        12.50%      12.371ms     106.648us           116  
                               _block_scaled_block_gemm         0.00%       0.000us         0.00%       0.000us       0.000us      11.839ms        11.96%      11.839ms      97.041us           122  
void deep_ep::internode_ll::dispatch<true, 3, 10, 71...         0.00%       0.000us         0.00%       0.000us       0.000us       7.068ms         7.14%       7.068ms      30.466us           232  
void deep_gemm::fp8_gemm_kernel<7168u, 16384u, 64u, ...         0.00%       0.000us         0.00%       0.000us       0.000us       4.450ms         4.50%       4.450ms      36.473us           122  
                             _per_token_group_quant_fp8         0.00%       0.000us         0.00%       0.000us       0.000us       2.549ms         2.58%       2.549ms       3.483us           732  
                                    grouped_topk_kernel         0.00%       0.000us         0.00%       0.000us       0.000us       2.366ms         2.39%       2.366ms      20.398us           116  
void deep_gemm::fp8_gemm_kernel<24576u, 1536u, 64u, ...         0.00%       0.000us         0.00%       0.000us       0.000us       1.836ms         1.86%       1.836ms      15.048us           122  
                                         _rotary_kernel         0.00%       0.000us         0.00%       0.000us       0.000us       1.804ms         1.82%       1.804ms      14.783us           122  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 206.333ms
Self CUDA time total: 98.961ms

Profile Prefill
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
void deep_ep::intranode::cached_notify_combine<8>(vo...         0.00%       0.000us         0.00%       0.000us       0.000us     413.043ms        25.51%     413.043ms       7.121ms            58  
                             _per_token_group_quant_fp8         0.00%       0.000us         0.00%       0.000us       0.000us     155.593ms         9.61%     155.593ms     286.543us           543  
void deep_ep::intranode::combine<__nv_bfloat16, 8, 7...         0.00%       0.000us         0.00%       0.000us       0.000us     127.154ms         7.85%     127.154ms       2.192ms            58  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us     109.499ms         6.76%     109.499ms       3.129ms            35  
                                  _fwd_kernel_ep_gather         0.00%       0.000us         0.00%       0.000us       0.000us      93.632ms         5.78%      93.632ms       1.614ms            58  
void deep_gemm::fp8_gemm_kernel<7168u, 16384u, 128u,...         0.00%       0.000us         0.00%       0.000us       0.000us      85.138ms         5.26%      85.138ms       1.396ms            61  
void deep_ep::intranode::dispatch<8, 512>(int4*, flo...         0.00%       0.000us         0.00%       0.000us       0.000us      81.884ms         5.06%      81.884ms       1.412ms            58  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us      74.030ms         4.57%      74.030ms       3.219ms            23  
                                         _rotary_kernel         0.00%       0.000us         0.00%       0.000us       0.000us      64.732ms         4.00%      64.732ms       1.061ms            61  
void deep_gemm::fp8_gemm_kernel<7168u, 2048u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us      59.905ms         3.70%      59.905ms       1.712ms            35  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 173.620ms
Self CUDA time total: 1.619s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 64u, 1...         0.00%       0.000us         0.00%       0.000us       0.000us      23.885ms        23.60%      23.885ms     205.903us           116  
void deep_ep::internode_ll::combine<3, 10, 7168, 9>(...         0.00%       0.000us         0.00%       0.000us       0.000us      13.554ms        13.40%      13.554ms      58.424us           232  
void deep_gemm::fp8_gemm_kernel<7168u, 2048u, 64u, 1...         0.00%       0.000us         0.00%       0.000us       0.000us      12.248ms        12.10%      12.248ms     105.587us           116  
                               _block_scaled_block_gemm         0.00%       0.000us         0.00%       0.000us       0.000us      11.862ms        11.72%      11.862ms      97.231us           122  
void deep_ep::internode_ll::dispatch<true, 3, 10, 71...         0.00%       0.000us         0.00%       0.000us       0.000us       9.357ms         9.25%       9.357ms      40.333us           232  
void deep_gemm::fp8_gemm_kernel<7168u, 16384u, 64u, ...         0.00%       0.000us         0.00%       0.000us       0.000us       4.442ms         4.39%       4.442ms      36.406us           122  
                             _per_token_group_quant_fp8         0.00%       0.000us         0.00%       0.000us       0.000us       2.567ms         2.54%       2.567ms       3.507us           732  
                                    grouped_topk_kernel         0.00%       0.000us         0.00%       0.000us       0.000us       2.360ms         2.33%       2.360ms      20.343us           116  
                                         _rotary_kernel         0.00%       0.000us         0.00%       0.000us       0.000us       1.928ms         1.91%       1.928ms      15.806us           122  
void deep_gemm::fp8_gemm_kernel<24576u, 1536u, 64u, ...         0.00%       0.000us         0.00%       0.000us       0.000us       1.841ms         1.82%       1.841ms      15.087us           122  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 206.326ms
Self CUDA time total: 101.189ms

Profile Prefill
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
void deep_ep::intranode::cached_notify_combine<8>(vo...         0.00%       0.000us         0.00%       0.000us       0.000us     459.888ms        28.16%     459.888ms       7.929ms            58  
                             _per_token_group_quant_fp8         0.00%       0.000us         0.00%       0.000us       0.000us     152.644ms         9.35%     152.644ms     281.112us           543  
void deep_ep::intranode::combine<__nv_bfloat16, 8, 7...         0.00%       0.000us         0.00%       0.000us       0.000us     127.306ms         7.79%     127.306ms       2.195ms            58  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us      92.974ms         5.69%      92.974ms       3.099ms            30  
                                  _fwd_kernel_ep_gather         0.00%       0.000us         0.00%       0.000us       0.000us      86.901ms         5.32%      86.901ms       1.498ms            58  
void deep_gemm::fp8_gemm_kernel<7168u, 16384u, 128u,...         0.00%       0.000us         0.00%       0.000us       0.000us      85.093ms         5.21%      85.093ms       1.395ms            61  
void deep_ep::intranode::dispatch<8, 512>(int4*, flo...         0.00%       0.000us         0.00%       0.000us       0.000us      81.411ms         4.98%      81.411ms       1.404ms            58  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us      77.604ms         4.75%      77.604ms       2.772ms            28  
                                         _rotary_kernel         0.00%       0.000us         0.00%       0.000us       0.000us      64.639ms         3.96%      64.639ms       1.060ms            61  
void deep_gemm::fp8_gemm_kernel<7168u, 2048u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us      50.367ms         3.08%      50.367ms       1.679ms            30  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 148.196ms
Self CUDA time total: 1.633s

prefill time cost: 5057.425260543823
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 64u, 1...         0.00%       0.000us         0.00%       0.000us       0.000us      23.596ms        24.70%      23.596ms     203.415us           116  
void deep_ep::internode_ll::combine<3, 10, 7168, 9>(...         0.00%       0.000us         0.00%       0.000us       0.000us      13.911ms        14.56%      13.911ms      59.962us           232  
void deep_gemm::fp8_gemm_kernel<7168u, 2048u, 64u, 1...         0.00%       0.000us         0.00%       0.000us       0.000us      12.142ms        12.71%      12.142ms     104.676us           116  
                               _block_scaled_block_gemm         0.00%       0.000us         0.00%       0.000us       0.000us      11.830ms        12.38%      11.830ms      96.968us           122  
void deep_gemm::fp8_gemm_kernel<7168u, 16384u, 64u, ...         0.00%       0.000us         0.00%       0.000us       0.000us       4.462ms         4.67%       4.462ms      36.574us           122  
void deep_ep::internode_ll::dispatch<true, 3, 10, 71...         0.00%       0.000us         0.00%       0.000us       0.000us       3.645ms         3.82%       3.645ms      15.713us           232  
                             _per_token_group_quant_fp8         0.00%       0.000us         0.00%       0.000us       0.000us       2.549ms         2.67%       2.549ms       3.482us           732  
                                    grouped_topk_kernel         0.00%       0.000us         0.00%       0.000us       0.000us       2.396ms         2.51%       2.396ms      20.652us           116  
                                         _rotary_kernel         0.00%       0.000us         0.00%       0.000us       0.000us       1.868ms         1.95%       1.868ms      15.308us           122  
void deep_gemm::fp8_gemm_kernel<24576u, 1536u, 64u, ...         0.00%       0.000us         0.00%       0.000us       0.000us       1.841ms         1.93%       1.841ms      15.091us           122  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 203.055ms
Self CUDA time total: 95.531ms

0 step cost time: 486.264705657959
100 step cost time: 97.17798233032227
127 step cost time: 97.11527824401855
time total cost(ms): 17954.286813735962
Profile Prefill
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
void deep_ep::intranode::cached_notify_combine<8>(vo...         0.00%       0.000us         0.00%       0.000us       0.000us     406.753ms        24.88%     406.753ms       7.013ms            58  
                             _per_token_group_quant_fp8         0.00%       0.000us         0.00%       0.000us       0.000us     157.113ms         9.61%     157.113ms     289.342us           543  
void deep_ep::intranode::combine<__nv_bfloat16, 8, 7...         0.00%       0.000us         0.00%       0.000us       0.000us     127.099ms         7.77%     127.099ms       2.191ms            58  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us     110.342ms         6.75%     110.342ms       3.448ms            32  
                                  _fwd_kernel_ep_gather         0.00%       0.000us         0.00%       0.000us       0.000us      94.109ms         5.76%      94.109ms       1.623ms            58  
void deep_gemm::fp8_gemm_kernel<7168u, 16384u, 128u,...         0.00%       0.000us         0.00%       0.000us       0.000us      86.727ms         5.31%      86.727ms       1.422ms            61  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us      85.202ms         5.21%      85.202ms       3.277ms            26  
void deep_ep::intranode::dispatch<8, 512>(int4*, flo...         0.00%       0.000us         0.00%       0.000us       0.000us      82.709ms         5.06%      82.709ms       1.426ms            58  
                                         _rotary_kernel         0.00%       0.000us         0.00%       0.000us       0.000us      64.857ms         3.97%      64.857ms       1.063ms            61  
void deep_gemm::fp8_gemm_kernel<7168u, 2048u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us      59.345ms         3.63%      59.345ms       1.855ms            32  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 149.388ms
Self CUDA time total: 1.635s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 64u, 1...         0.00%       0.000us         0.00%       0.000us       0.000us      24.367ms        25.44%      24.367ms     210.064us           116  
void deep_ep::internode_ll::combine<3, 10, 7168, 9>(...         0.00%       0.000us         0.00%       0.000us       0.000us      12.918ms        13.49%      12.918ms      55.680us           232  
void deep_gemm::fp8_gemm_kernel<7168u, 2048u, 64u, 1...         0.00%       0.000us         0.00%       0.000us       0.000us      12.466ms        13.02%      12.466ms     107.466us           116  
                               _block_scaled_block_gemm         0.00%       0.000us         0.00%       0.000us       0.000us      11.815ms        12.34%      11.815ms      96.841us           122  
void deep_gemm::fp8_gemm_kernel<7168u, 16384u, 64u, ...         0.00%       0.000us         0.00%       0.000us       0.000us       4.443ms         4.64%       4.443ms      36.421us           122  
void deep_ep::internode_ll::dispatch<true, 3, 10, 71...         0.00%       0.000us         0.00%       0.000us       0.000us       3.913ms         4.08%       3.913ms      16.864us           232  
                             _per_token_group_quant_fp8         0.00%       0.000us         0.00%       0.000us       0.000us       2.563ms         2.68%       2.563ms       3.501us           732  
                                    grouped_topk_kernel         0.00%       0.000us         0.00%       0.000us       0.000us       2.399ms         2.50%       2.399ms      20.683us           116  
void deep_gemm::fp8_gemm_kernel<24576u, 1536u, 64u, ...         0.00%       0.000us         0.00%       0.000us       0.000us       1.844ms         1.93%       1.844ms      15.115us           122  
                                         _rotary_kernel         0.00%       0.000us         0.00%       0.000us       0.000us       1.820ms         1.90%       1.820ms      14.920us           122  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 203.464ms
Self CUDA time total: 95.781ms

Profile Prefill
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
void deep_ep::intranode::cached_notify_combine<8>(vo...         0.00%       0.000us         0.00%       0.000us       0.000us     422.551ms        25.84%     422.551ms       7.285ms            58  
                             _per_token_group_quant_fp8         0.00%       0.000us         0.00%       0.000us       0.000us     155.874ms         9.53%     155.874ms     287.061us           543  
void deep_ep::intranode::combine<__nv_bfloat16, 8, 7...         0.00%       0.000us         0.00%       0.000us       0.000us     127.037ms         7.77%     127.037ms       2.190ms            58  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us     105.225ms         6.44%     105.225ms       3.628ms            29  
                                  _fwd_kernel_ep_gather         0.00%       0.000us         0.00%       0.000us       0.000us      91.787ms         5.61%      91.787ms       1.583ms            58  
void deep_gemm::fp8_gemm_kernel<7168u, 16384u, 128u,...         0.00%       0.000us         0.00%       0.000us       0.000us      84.897ms         5.19%      84.897ms       1.392ms            61  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us      83.555ms         5.11%      83.555ms       2.881ms            29  
void deep_ep::intranode::dispatch<8, 512>(int4*, flo...         0.00%       0.000us         0.00%       0.000us       0.000us      82.404ms         5.04%      82.404ms       1.421ms            58  
                                         _rotary_kernel         0.00%       0.000us         0.00%       0.000us       0.000us      64.677ms         3.96%      64.677ms       1.060ms            61  
void deep_gemm::fp8_gemm_kernel<7168u, 2048u, 128u, ...         0.00%       0.000us         0.00%       0.000us       0.000us      55.569ms         3.40%      55.569ms       1.916ms            29  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 147.816ms
Self CUDA time total: 1.635s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
void deep_gemm::fp8_gemm_kernel<4096u, 7168u, 64u, 1...         0.00%       0.000us         0.00%       0.000us       0.000us      24.042ms        24.28%      24.042ms     207.263us           116  
void deep_ep::internode_ll::combine<3, 10, 7168, 9>(...         0.00%       0.000us         0.00%       0.000us       0.000us      13.440ms        13.57%      13.440ms      57.932us           232  
void deep_gemm::fp8_gemm_kernel<7168u, 2048u, 64u, 1...         0.00%       0.000us         0.00%       0.000us       0.000us      12.279ms        12.40%      12.279ms     105.850us           116  
                               _block_scaled_block_gemm         0.00%       0.000us         0.00%       0.000us       0.000us      11.913ms        12.03%      11.913ms      97.647us           122  
void deep_ep::internode_ll::dispatch<true, 3, 10, 71...         0.00%       0.000us         0.00%       0.000us       0.000us       7.054ms         7.12%       7.054ms      30.404us           232  
void deep_gemm::fp8_gemm_kernel<7168u, 16384u, 64u, ...         0.00%       0.000us         0.00%       0.000us       0.000us       4.444ms         4.49%       4.444ms      36.428us           122  
                             _per_token_group_quant_fp8         0.00%       0.000us         0.00%       0.000us       0.000us       2.539ms         2.56%       2.539ms       3.469us           732  
                                    grouped_topk_kernel         0.00%       0.000us         0.00%       0.000us       0.000us       2.389ms         2.41%       2.389ms      20.591us           116  
void deep_gemm::fp8_gemm_kernel<24576u, 1536u, 64u, ...         0.00%       0.000us         0.00%       0.000us       0.000us       1.845ms         1.86%       1.845ms      15.119us           122  
                                         _rotary_kernel         0.00%       0.000us         0.00%       0.000us       0.000us       1.790ms         1.81%       1.790ms      14.669us           122  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 203.436ms
Self CUDA time total: 99.011ms

